import { Logger } from '../logger';
import { ConnectionPool, ConnectionPoolOptions, ConnectionPoolEvents } from '../cmap/connection_pool';
import { ServerDescription } from './server_description';
import { Monitor, MonitorOptions } from './monitor';
import { Callback, MongoDBNamespace, EventEmitterWithState } from '../utils';
import { ClusterTime } from './common';
import { Connection, DestroyOptions, QueryOptions, GetMoreOptions, CommandOptions } from '../cmap/connection';
import type { Long } from '../bson';
import type { Topology } from './topology';
import type { ServerHeartbeatFailedEvent, ServerHeartbeatStartedEvent, ServerHeartbeatSucceededEvent } from './events';
import type { Document } from '../bson';
import type { AutoEncrypter } from '../deps';
import type { ServerApi } from '../mongo_client';
import { TypedEventEmitter } from '../mongo_types';
/** @internal */
declare const kMonitor: unique symbol;
/** @public */
export declare type ServerOptions = Omit<ConnectionPoolOptions, 'id' | 'generation' | 'hostAddress'> & MonitorOptions;
/** @internal */
export interface ServerPrivate {
    /** The server description for this server */
    description: ServerDescription;
    /** A copy of the options used to construct this instance */
    options: ServerOptions;
    /** A logger instance */
    logger: Logger;
    /** The current state of the Server */
    state: string;
    /** The topology this server is a part of */
    topology: Topology;
    /** A connection pool for this server */
    pool: ConnectionPool;
    /** MongoDB server API version */
    serverApi?: ServerApi;
}
/** @public */
export declare type ServerEvents = {
    serverHeartbeatStarted(event: ServerHeartbeatStartedEvent): void;
    serverHeartbeatSucceeded(event: ServerHeartbeatSucceededEvent): void;
    serverHeartbeatFailed(event: ServerHeartbeatFailedEvent): void;
    /** Top level MongoClient doesn't emit this so it is marked: @internal */
    connect(server: Server): void;
    descriptionReceived(description: ServerDescription): void;
    closed(): void;
    ended(): void;
} & ConnectionPoolEvents & EventEmitterWithState;
/** @internal */
export declare class Server extends TypedEventEmitter<ServerEvents> {
    /** @internal */
    s: ServerPrivate;
    serverApi?: ServerApi;
    clusterTime?: ClusterTime;
    ismaster?: Document;
    [kMonitor]: Monitor;
    /** @event */
    static readonly SERVER_HEARTBEAT_STARTED: "serverHeartbeatStarted";
    /** @event */
    static readonly SERVER_HEARTBEAT_SUCCEEDED: "serverHeartbeatSucceeded";
    /** @event */
    static readonly SERVER_HEARTBEAT_FAILED: "serverHeartbeatFailed";
    /** @event */
    static readonly CONNECT: "connect";
    /** @event */
    static readonly DESCRIPTION_RECEIVED: "descriptionReceived";
    /** @event */
    static readonly CLOSED: "closed";
    /** @event */
    static readonly ENDED: "ended";
    /**
     * Create a server
     */
    constructor(topology: Topology, description: ServerDescription, options: ServerOptions);
    get description(): ServerDescription;
    get name(): string;
    get autoEncrypter(): AutoEncrypter | undefined;
    get loadBalanced(): boolean;
    /**
     * Initiate server connect
     */
    connect(): void;
    /** Destroy the server connection */
    destroy(options?: DestroyOptions, callback?: Callback): void;
    /**
     * Immediately schedule monitoring of this server. If there already an attempt being made
     * this will be a no-op.
     */
    requestCheck(): void;
    /**
     * Execute a command
     * @internal
     */
    command(ns: MongoDBNamespace, cmd: Document, callback: Callback): void;
    /** @internal */
    command(ns: MongoDBNamespace, cmd: Document, options: CommandOptions, callback: Callback<Document>): void;
    /**
     * Unpinning a connection returns it to the pool.
     */
    unpinConnection(connection: Connection): void;
    /**
     * Execute a query against the server
     * @internal
     */
    query(ns: MongoDBNamespace, cmd: Document, options: QueryOptions, callback: Callback): void;
    /**
     * Execute a `getMore` against the server
     * @internal
     */
    getMore(ns: MongoDBNamespace, cursorId: Long, options: GetMoreOptions, callback: Callback<Document>): void;
    /**
     * Execute a `killCursors` command against the server
     * @internal
     */
    killCursors(ns: MongoDBNamespace, cursorIds: Long[], options: CommandOptions, callback?: Callback): void;
}
export declare const HEARTBEAT_EVENTS: ("serverHeartbeatStarted" | "serverHeartbeatSucceeded" | "serverHeartbeatFailed")[];
export {};
//# sourceMappingURL=server.d.ts.map